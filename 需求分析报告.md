# 个人财务管理系统需求分析报告

## 1. 项目背景与目标

### 1.1 项目背景

随着社会经济的发展和个人收入水平的提高，越来越多的人开始关注个人财务管理。传统的记账方式（如纸质账本、Excel表格）存在操作繁琐、数据统计困难、分析能力有限等问题。同时，移动支付的普及使得个人交易记录日益增多，如何高效管理这些交易数据成为了一个现实需求。

### 1.2 项目目标

开发一个功能完善的个人财务管理系统，帮助用户：
- 便捷地记录和管理个人交易
- 智能分类交易数据，减少手动操作
- 直观地分析收支情况，了解消费模式
- 合理规划预算，实现财务目标
- 安全地导入导出数据，确保数据的可移植性

## 2. 功能需求

### 2.0 UML建模

#### 2.0.1 用例图（Use Case Diagram）

```
┌─────────────────────────────────────────────────────────────────┐
│                    个人财务管理系统                          │
└─────────────────────────────────────────────────────────────────┘
                            │
                            │
           ┌────────────────┴────────────────┐
           │                                 │
    ┌──────▼──────┐                 ┌──────▼──────┐
    │   用户      │                 │   系统      │
    └──────┬──────┘                 └──────┬──────┘
           │                               │
           │                               │
    ┌──────┼───────────────────────────────┼──────┐
    │      │                               │      │
    │      │                               │      │
┌───▼──┐  │                          ┌───▼──┐  │
│注册  │  │                          │登录  │  │
└───┬──┘  │                          └───┬──┘  │
    │     │                               │     │
    │     │                               │     │
    │     │                          ┌────▼────┐
    │     │                          │登出    │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │查看仪表盘│
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │管理交易  │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │添加交易  │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │编辑交易  │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │删除交易  │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │筛选交易  │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │管理分类  │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │添加分类  │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │编辑分类  │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │删除分类  │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │查看统计  │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │管理预算  │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │设置预算  │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │导出数据  │
    │     │                          └────┬────┘
    │     │                               │
    │     │                          ┌────▼────┐
    │     │                          │一键分类  │
    │     │                          └─────────┘
    │     │
    │     │
└─────┴─────┘
```

#### 2.0.2 类图（Class Diagram）

```
┌─────────────────────────────────────────────────────────────────┐
│                         User                             │
├─────────────────────────────────────────────────────────────────┤
│ - id: String                                             │
│ - email: String                                           │
│ - password: String                                        │
│ - name: String?                                          │
│ - createdAt: DateTime                                     │
│ - updatedAt: DateTime                                     │
├─────────────────────────────────────────────────────────────────┤
│ + transactions: Transaction[]                              │
│ + categories: Category[]                                   │
│ + budgets: Budget[]                                      │
└─────────────────────────────────────────────────────────────────┘
                            │
                            │ 1
                            │
                            │ *
                ┌───────────▼───────────┐
                │   Transaction       │
                ├───────────────────────┤
                │ - id: String        │
                │ - userId: String     │
                │ - type: String      │
                │ - amount: Float      │
                │ - categoryId: String? │
                │ - description: String?│
                │ - date: DateTime    │
                │ - createdAt: DateTime│
                │ - updatedAt: DateTime│
                ├───────────────────────┤
                │ + user: User        │
                │ + category: Category?│
                └───────────┬───────────┘
                            │
                            │ *
                            │
                            │ 1
                ┌───────────▼───────────┐
                │     Category        │
                ├───────────────────────┤
                │ - id: String        │
                │ - userId: String     │
                │ - name: String      │
                │ - type: String      │
                │ - icon: String?     │
                │ - color: String?    │
                │ - createdAt: DateTime│
                │ - updatedAt: DateTime│
                ├───────────────────────┤
                │ + user: User        │
                │ + transactions: Transaction[]│
                └───────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│                         Budget                            │
├─────────────────────────────────────────────────────────────────┤
│ - id: String                                             │
│ - userId: String                                          │
│ - categoryId: String?                                     │
│ - amount: Float                                          │
│ - month: Int                                             │
│ - year: Int                                              │
│ - createdAt: DateTime                                     │
│ - updatedAt: DateTime                                     │
├─────────────────────────────────────────────────────────────────┤
│ + user: User                                             │
│ + category: Category?                                     │
└─────────────────────────────────────────────────────────────────┘
```

#### 2.0.3 活动图（Activity Diagram）- 用户登录流程

```
┌─────────┐
│  开始   │
└────┬────┘
     │
     ▼
┌─────────────┐
│打开登录页面  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│输入邮箱和密码 │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│点击登录按钮  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│验证输入数据  │
└─────┬───────┘
      │
      ▼
   ┌───┴───┐
   │        │
   │有效    │无效
   ▼        ▼
┌───────┐ ┌──────────┐
│发送登录│ │显示错误  │
│请求   │ │提示      │
└───┬───┘ └────┬─────┘
    │         │
    ▼         │
┌───────────┐  │
│验证用户身份│  │
└─────┬─────┘  │
      │        │
      ▼        │
   ┌───┴───┐   │
   │        │   │
   │成功    │失败
   ▼        ▼
┌─────────┐ ┌─────────┐
│创建会话 │ │显示登录  │
│跳转首页 │ │失败提示 │
└────┬────┘ └─────────┘
     │
     ▼
┌─────────┐
│  结束   │
└─────────┘
```

#### 2.0.4 序列图（Sequence Diagram）- 添加交易流程

```
用户          前端界面          API路由          数据库
 │               │                │               │
 │────添加交易───▶│                │               │
 │               │                │               │
 │               │────验证表单─────▶│               │
 │               │                │               │
 │               │◀────验证结果────│               │
 │               │                │               │
 │               │────创建交易─────▶│               │
 │               │                │               │
 │               │                │────插入数据─────▶│
 │               │                │               │
 │               │                │◀────插入结果────│
 │               │                │               │
 │               │◀────返回结果────│               │
 │◀────显示成功───│                │               │
 │               │                │               │
```

### 2.1 用户认证模块

| 功能点 | 描述 | 优先级 |
|-------|------|-------|
| 用户注册 | 支持用户通过邮箱、密码和姓名进行注册 | 高 |
| 用户登录 | 支持用户通过邮箱和密码进行登录 | 高 |
| 会话管理 | 支持用户会话的创建、维护和销毁 | 高 |
| 密码加密 | 使用bcrypt对用户密码进行加密存储 | 高 |
| 身份验证 | 确保用户只能访问自己的数据 | 高 |

### 2.2 收支记录模块

| 功能点 | 描述 | 优先级 |
|-------|------|-------|
| 添加收入/支出记录 | 支持用户添加收入或支出记录，包括金额、分类、日期、描述等信息 | 高 |
| 编辑记录 | 支持用户编辑已有的交易记录 | 高 |
| 删除记录 | 支持用户删除交易记录 | 高 |
| 查询记录 | 支持用户按日期、分类等条件筛选交易记录 | 中 |
| 记录列表展示 | 以列表形式展示交易记录，支持分页 | 高 |
| 表单验证 | 对用户输入进行验证，确保数据的合法性 | 高 |

### 2.3 分类管理模块

| 功能点 | 描述 | 优先级 |
|-------|------|-------|
| 创建分类 | 支持用户创建收入或支出分类 | 高 |
| 编辑分类 | 支持用户编辑已有的分类 | 中 |
| 删除分类 | 支持用户删除分类 | 中 |
| 分类图标/颜色管理 | 支持为分类设置图标和颜色，提高视觉识别度 | 中 |
| 预设分类 | 提供常用的预设分类，方便用户快速开始使用 | 低 |

### 2.4 统计图表模块

| 功能点 | 描述 | 优先级 |
|-------|------|-------|
| 收支趋势图 | 使用折线图展示收支随时间的变化趋势 | 高 |
| 分类占比图 | 使用饼图展示不同分类的收支占比 | 高 |
| 月度统计 | 使用柱状图展示月度收支情况 | 高 |
| 收支对比 | 使用双柱状图展示收支对比情况 | 中 |
| 日期范围选择器 | 支持用户选择统计的日期范围 | 中 |
| 数据汇总卡片 | 以卡片形式展示关键数据汇总，如总收入、总支出、结余等 | 高 |

### 2.5 预算管理模块

| 功能点 | 描述 | 优先级 |
|-------|------|-------|
| 设置月度预算 | 支持用户设置月度预算金额 | 高 |
| 预算进度显示 | 实时显示预算使用情况和进度 | 高 |
| 预算超支预警 | 当预算使用超过阈值时，进行预警提示 | 中 |
| 预算历史记录 | 支持查看历史预算设置和使用情况 | 中 |
| 预算建议 | 基于历史数据，为用户提供预算设置建议 | 低 |

### 2.6 数据导出模块

| 功能点 | 描述 | 优先级 |
|-------|------|-------|
| 导出为CSV格式 | 支持将交易数据导出为CSV格式 | 高 |
| 导出为Excel格式 | 支持将交易数据导出为Excel格式（可选） | 中 |
| 按日期范围导出 | 支持按指定日期范围导出数据 | 中 |
| 导出分类筛选 | 支持按分类筛选导出数据 | 中 |

### 2.7 公共组件

| 功能点 | 描述 | 优先级 |
|-------|------|-------|
| 导航栏 | 提供系统主要功能的导航链接 | 高 |
| 侧边栏 | 提供系统功能的详细导航菜单 | 高 |
| 布局组件 | 提供系统页面的统一布局结构 | 高 |
| 加载状态 | 提供数据加载过程中的视觉反馈 | 中 |
| 错误提示 | 提供错误信息的友好展示 | 中 |
| 确认对话框 | 提供操作确认的对话框 | 中 |
| 表单组件 | 提供统一的表单输入组件，如输入框、选择器、按钮等 | 高 |

### 2.8 工具函数和类型定义

| 功能点 | 描述 | 优先级 |
|-------|------|-------|
| 日期格式化 | 提供日期的标准化格式化功能 | 中 |
| 金额格式化 | 提供金额的标准化格式化功能 | 中 |
| 数据验证 | 提供数据合法性的验证功能 | 中 |
| TypeScript类型定义 | 提供系统中使用的TypeScript类型定义 | 高 |
| API响应类型 | 提供API响应的标准化类型定义 | 高 |

## 3. 非功能需求

| 需求点 | 描述 | 优先级 |
|-------|------|-------|
| 响应快 | 系统响应时间不超过2秒，页面加载时间不超过3秒 | 高 |
| 数据安全 | 用户密码加密存储，所有API请求需要身份验证，数据隔离确保用户只能访问自己的数据 | 高 |
| 可用性 | 系统可用性达到99.9%，支持常见浏览器（Chrome、Firefox、Safari、Edge） | 中 |
| 可维护性 | 代码结构清晰，文档完整，便于后续维护和扩展 | 中 |
| 兼容性 | 支持响应式设计，适配不同屏幕尺寸的设备 | 中 |

## 4. 数据需求

### 4.1 数据模型

| 实体 | 字段 | 类型 | 描述 |
|------|------|------|------|
| User | id | String | 用户ID |
| User | email | String | 用户邮箱（唯一） |
| User | password | String | 用户密码（加密） |
| User | name | String | 用户姓名 |
| User | createdAt | DateTime | 创建时间 |
| User | updatedAt | DateTime | 更新时间 |
| User | transactions | Transaction[] | 用户的交易记录 |
| User | categories | Category[] | 用户的分类 |
| User | budgets | Budget[] | 用户的预算 |
| Transaction | id | String | 交易ID |
| Transaction | userId | String | 用户ID（外键） |
| Transaction | type | String | 交易类型（income/expense） |
| Transaction | amount | Float | 交易金额 |
| Transaction | categoryId | String | 分类ID（外键） |
| Transaction | description | String | 交易描述 |
| Transaction | date | DateTime | 交易日期 |
| Transaction | createdAt | DateTime | 创建时间 |
| Transaction | updatedAt | DateTime | 更新时间 |
| Category | id | String | 分类ID |
| Category | userId | String | 用户ID（外键） |
| Category | name | String | 分类名称 |
| Category | type | String | 分类类型（income/expense） |
| Category | icon | String | 分类图标 |
| Category | color | String | 分类颜色 |
| Category | createdAt | DateTime | 创建时间 |
| Category | updatedAt | DateTime | 更新时间 |
| Category | transactions | Transaction[] | 分类下的交易记录 |
| Budget | id | String | 预算ID |
| Budget | userId | String | 用户ID（外键） |
| Budget | categoryId | String | 分类ID（外键，可选） |
| Budget | amount | Float | 预算金额 |
| Budget | month | Int | 预算月份（1-12） |
| Budget | year | Int | 预算年份 |
| Budget | createdAt | DateTime | 创建时间 |
| Budget | updatedAt | DateTime | 更新时间 |

### 4.2 数据安全

- 用户密码使用bcryptjs加密存储
- 所有API请求都需要验证用户身份
- 数据隔离确保用户只能访问和修改自己的数据
- 输入数据经过严格验证，防止恶意输入

## 5. 技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| Next.js | 14 | React全栈框架，支持App Router |
| TypeScript | - | 类型安全，提升代码质量 |
| Prisma | - | 现代化ORM，简化数据库操作 |
| SQLite | - | 轻量级数据库，无需额外配置 |
| Tailwind CSS | - | 实用优先的CSS框架 |
| Recharts | - | 基于React的图表库 |
| bcryptjs | - | 密码加密库 |
| ESLint | - | 代码检查工具 |
| Prettier | - | 代码格式化工具 |
| Zod | - | 数据验证库 |

## 6. 范围限定

- 本系统仅支持个人财务管理，不支持企业级财务功能
- 系统使用SQLite作为数据库，适合个人使用，不支持大规模并发
- 系统支持的导出文件格式限于CSV和Excel格式
- 系统支持的导入功能限于程序自身导出的CSV文件

## 7. 验收标准

### 7.1 功能验收

| 功能点 | 验收标准 |
|-------|---------|
| 用户认证 | 能够成功注册、登录、登出，且用户数据隔离正确 |
| 收支记录 | 能够成功添加、编辑、删除交易，交易列表显示正确，筛选功能正常 |
| 分类管理 | 能够成功添加、编辑、删除分类，分类图标/颜色设置正确 |
| 统计图表 | 收支趋势图、分类占比图、月度统计图显示正确，数据汇总卡片显示正确 |
| 预算管理 | 能够成功设置预算，预算进度显示正确，预算超支预警功能正常 |
| 数据导出 | 能够成功导出CSV和Excel格式数据，导出数据完整正确 |
| 公共组件 | 导航栏、侧边栏、布局组件等公共组件功能正常，UI美观 |
| 工具函数 | 日期格式化、金额格式化、数据验证等工具函数功能正常 |

### 7.2 非功能验收

| 需求点 | 验收标准 |
|-------|---------|
| 响应快 | 系统响应时间不超过2秒，页面加载时间不超过3秒 |
| 数据安全 | 密码加密存储，API请求需要身份验证，数据隔离正确 |
| 可用性 | 系统在常见浏览器中运行正常，功能无异常 |
| 可维护性 | 代码结构清晰，文档完整 |
| 兼容性 | 系统在不同屏幕尺寸的设备上显示正常，响应式设计正确 |

## 8. 风险与依赖

### 8.1 风险

| 风险点 | 描述 | 缓解措施 |
|-------|------|---------|
| 数据丢失 | 系统故障或用户操作不当可能导致数据丢失 | 定期备份数据，提供数据导出功能 |
| 安全漏洞 | 系统可能存在安全漏洞，导致用户数据泄露 | 定期更新依赖库，进行安全审计 |
| 性能问题 | 随着交易数据的增加，系统可能出现性能下降 | 优化数据库查询，添加适当的索引，实现数据分页 |
| 兼容性问题 | 系统在不同浏览器或设备上可能出现显示异常 | 进行充分的跨浏览器测试，实现响应式设计 |

### 8.2 依赖

| 依赖项 | 描述 | 版本要求 |
|-------|------|---------|
| Next.js | 前端框架 | 14 |
| React | UI库 | 与Next.js 14兼容 |
| TypeScript | 类型系统 | 最新稳定版 |
| Prisma | ORM工具 | 最新稳定版 |
| SQLite | 数据库 | 内置 |
| Tailwind CSS | 样式框架 | 最新稳定版 |
| Recharts | 图表库 | 最新稳定版 |
| bcryptjs | 密码加密库 | 最新稳定版 |
| Zod | 数据验证库 | 最新稳定版 |

## 9. 结论

本需求分析报告基于个人财务管理系统的开发计划，详细描述了系统的功能需求、非功能需求、数据需求、技术栈、范围限定和验收标准。系统采用现代化的技术栈，功能完善，能够满足个人用户的财务管理需求。

通过用户认证、收支记录、分类管理、统计图表、预算管理、数据导出等模块的实现，系统将为用户提供便捷、高效、安全的财务管理体验。同时，系统的响应式设计和良好的用户界面将提高用户的使用体验。

本需求分析报告为系统的开发提供了清晰的指导，确保开发团队能够按照需求实现系统的各项功能，最终交付一个高质量的个人财务管理系统。